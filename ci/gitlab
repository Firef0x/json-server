#!/bin/sh

set -e

VERSION=$(cat VERSION)
DOCKER_REGISTRY_HOST=192.168.1.230:3005
DOCKER_IMAGE=tenmic/json-server

docker build -t $DOCKER_IMAGE .

docker tag $DOCKER_IMAGE $DOCKER_REGISTRY_HOST/$DOCKER_IMAGE:latest
docker tag $DOCKER_IMAGE $DOCKER_REGISTRY_HOST/$DOCKER_IMAGE:$VERSION

docker push $DOCKER_REGISTRY_HOST/$DOCKER_IMAGE:latest
docker push $DOCKER_REGISTRY_HOST/$DOCKER_IMAGE:$VERSION
